<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giuse Vũ Duy Linh</title>
    <link rel="stylesheet" href="style.css" >
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>

<body>
    <div class="profile-container">
		<div class="profile-header">
			<img src="Linh.png" alt="Vũ Duy Linh" style="width: 150px; height: 150px; border-radius: 50%; margin-bottom: 10px; object-fit: cover;">
			<h2>Maria</h2>
			<h2>Lê Nhật Linh</h2>
		</div>
        <div class="profile-details">
            <ul class="skills">
                <li>Gx Thái Bình</li>
                <li>Giáo Hạt Gò Vấp</li>
				<li>Ban Truyền Thông</li>
            </ul>
        </div>
		<div class="skills">
			<h2>Sa Mạc Huấn Luyện HT Cấp 1 Horeb 101: </h2>
			<div class="attendance">
				<h4>Điểm danh:</h4>
				<div class="checkbox-grid"></div>
			</div>
			<h4>Chuyên Cần:</h4>
			<!-- Kỹ năng 1 -->
			<div class="skill-container">
				<div class="skill-bar skill-level" style="width: 100%;">100%</div>
			</div>
			<!-- Thêm kỹ năng khác ở đây... -->
		</div>
		<div class="biography">
			<h2>Tiểu Sử & Thành Tích</h2>
			<p>Maria Lê Nhật Linh tham dự  Sa Mạc Horeb 101 với vai trò Ban Truyền Thông. Từ vị trí này, cô tha hồ sỉ vả anh em trong ban, dằn mặt các Sa Mạc Sinh</p>
		</div>
		
    </div>
	<script>
		async function fetchDataFromServer() {
			try {				
				let data = await fetch('../data.csv')
				.then(response => response.text())
				.then(csvString => {
					return Papa.parse(csvString, {
						header: true,
						skipEmptyLines: true
					}).data;
				});
			
				let userId = 185;

				let user = data.find(p => p.id == userId); // Tìm người dùng có id trùng với id của người dùng hiện tại
				console.log(user.diemDanh);
				let diemDanh = user.diemDanh.split(',');
				let diemDanhFull = user.diemDanh.split(',');

				const activeCount = diemDanh.filter(value => value === "true").length; // Đếm số lượng giá trị true
				const chuyencan = (activeCount / 9) * 100;

				const checkboxContainer = document.querySelector(".checkbox-grid");
				const skillBar = document.querySelector(".skill-bar");
				
				// Cập nhật phần trăm cho skill-bar
				skillBar.style.width = `${chuyencan.toFixed(2)}%`;
				skillBar.textContent = `${chuyencan.toFixed(2)}%`;			
			
				diemDanhFull.forEach((isChecked, index) => {
					let check = false;
					if(isChecked=='true'){check =true}
					const container = document.createElement("div");
					container.className = "checkbox-container";

					const checkbox = document.createElement("input");
					checkbox.type = "checkbox";
					checkbox.id = "checkbox" + index;
					checkbox.checked = check;
					checkbox.disabled = true;

					const label = document.createElement("label");
					label.htmlFor = "checkbox" + index;
					label.textContent = "Ngày " + (index + 1);

					container.appendChild(checkbox);
					container.appendChild(label);
					checkboxContainer.appendChild(container);
				});		

			} catch (error) {
				console.error("Lỗi khi lấy dữ liệu từ máy chủ:", error);
			}
		}

		window.onload = fetchDataFromServer;
	</script>
</body>

</html>